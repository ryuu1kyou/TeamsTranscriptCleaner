# TeamsTranscriptCleaner

## 概要

Microsoft Teamsの自動生成トランスクリプト（議事録）は、しばしば漏字・脱字や誤字が含まれます。本ツール「TeamsTranscriptCleaner」は、アップロードされた議事録テキストと誤字脱字一覧（CSV）をもとに、OpenAI APIを活用して高精度な訂正を行うWebアプリケーションです。主な目的は、会議記録の品質向上と、訂正作業の効率化です。

---

## フォルダ構成例

```
TeamsTranscriptCleaner/
├── ui_components/         # 画面入出力層（Streamlit等）
├── processing/            # 業務処理層（CSVパース・API連携等）
├── sample_data/           # サンプルデータ（テキスト・CSV）
├── requirements.txt       # 必要パッケージ
├── .env.example           # APIキー設定例
├── README.md
└── ...
```

---

## 要件整理

### 基本要件

- 入力：トランスクリプト（テキスト）、訂正単語集（CSV）
- 出力：訂正済み議事録
- UI：ファイルアップロード、訂正実行、結果表示・ダウンロード
- 訂正方法：OpenAI API＋単語集
- セットアップ・実行手順・APIキー設定方法・サンプルデータ利用方法も含めること

### モジュール要件

- UI処理と業務ロジックの分離
- モジュール配置：`ui_components/`と `processing/`の分離
- インターフェース設計：明確なデータ構造定義
- テストコード実装：重要ロジックにはユニットテスト

---

## セットアップ手順

1. 必要なパッケージのインストール
   ```
   pip install -r requirements.txt
   ```
2. OpenAI APIキーの設定
   - Windows環境変数 `OPENAI_API_KEY` に設定してください
   - システム環境変数に追加する方法：
     1. スタートメニューで「環境変数」と検索
     2. 「システム環境変数の編集」を選択
     3. 「環境変数」ボタンをクリック
     4. 「システム環境変数」セクションで「新規」をクリック
     5. 変数名に `OPENAI_API_KEY`、変数値にAPIキーを入力
     6. 「OK」をクリックして保存
3. サンプルデータの利用
   - `sample_data/` フォルダ内にサンプルの議事録テキストと誤字脱字CSVを配置しています。
   - テストや動作確認にご利用ください。

---

## 実行方法

1. Streamlitアプリの起動
   ```
   streamlit run ui_components/app.py
   ```
2. ブラウザで表示される画面から、
   - 訂正前議事録（TXT）と誤字脱字一覧（CSV）をアップロード
   - モデル選択・プロンプト編集・訂正実行・結果ダウンロード等を操作

---

## UI詳細要件

- Streamlitを使用し、画面を左3割・右7割で分割
- 左側上部にOpenAIモデル選択（コンボボックス、料金のかからない最近の5モデルのみ）
- 左側上部にカスタムプロンプト入力欄（デフォルト：漏字脱字訂正優先、日本語文法訂正は次、意思齟齬は禁止）
- 左側に訂正前の議事録（TXT限定）アップロードボタン
- 左側に誤字脱字一覧表示テキストエリア（CSV形式表示・編集可、アップロード直後はプレースホルダ表示）
- 左側に誤字脱字一覧（CSV限定）アップロードボタン
- 左側下部に訂正実行ボタン
- 左側一番下に「最終修正結果をダウンロード」ボタン
- 右側上部に訂正前ファイルの内容表示（修正履歴をコンボボックスで切り替え可能）
- 右側下部に訂正後ファイルの内容表示（手修正可能なテキストエリア、訂正箇所は赤太字で差分マーク）
- 右側下部の訂正後テキストを右上の訂正前テキスト欄にコピーするボタンを設置
- ユーザーが何度もOpenAIに再訂正を依頼できる運用を想定
- 要件のうち「漏字脱字の訂正」を最優先事項とすることを明記

---

## 工程分解・設計

### 構造設計

- モジュール分割：
  1. `ui_components/`：画面入出力層
     - ファイルアップロードハンドラ
     - モデル選択UI
     - プロンプトカスタマイザ
     - 結果表示リーダー
  2. `processing/`：業務処理層
     - CSVパーサモジュール
     - OpenAI API通信インタフェース
     - トークン数管理モジュール
     - 訂正済テキストビューア

### データフロー設計

1. UIコンポーネントからファイル入力取得
2. 入力検証
3. 加工ロジック実行
4. 結果のUI表示

### インターフェース設計

- JSONによるデータ交換フォーマット統一
- バージョニング可能なAPI設計
- エラーオブジェクト統一設計
- 訂正結果の表示（差分表示も検討）、ダウンロード
- エラーハンドリング

---

## アイディア・工夫

- 双方向編集機能やリアルタイムプレビュー機能
- 単語集のテキスト編集・保存機能、差分色分け表示
- トークン数制限時の自動分割
- APIキー安全管理、コスト表示

---

## 実装・運用面

- サンプルでのテスト、想定外入力対応
- 保守性（単語集拡張、カスタマイズ）、多言語対応
- ログ保存、ドキュメント整備
- セットアップ・APIキー管理・サンプルデータ利用方法の明記

---

## 注意事項

- OpenAI APIの利用には別途APIキーと利用料金が発生します。
- APIキーは厳重に管理し、公開リポジトリ等に絶対に含めないでください。
- サンプルデータは動作確認用です。実運用時はご自身のデータをご利用ください。

## 開発ロードマップ案

- まず最小限のプロトタイプ（アップロード→訂正→DL）
- 差分表示など機能拡張
- UI/UX改善、保守・運用体制整備
- 複数ユーザー対応

  - ユーザー認証機能の追加
  - ユーザーごとの設定保存
  - 単語集の共有機能
  - 権限管理（管理者/一般ユーザー）
